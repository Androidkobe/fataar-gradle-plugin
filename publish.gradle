apply plugin: 'maven'

def projectDesc = 'This is a gradle plugin that helps to output fat aar from android library.'

task sourcesJar(type: Jar) {
    classifier = 'sources'
    group BasePlugin.BUILD_GROUP
    description = 'Assembles a jar archive containing the main sources of this project.'
    from sourceSets.main.allSource
}

artifacts {
    archives sourcesJar
}

uploadArchives {
    repositories {
        mavenDeployer {
            def repositoryUrl
            if (version.contains("SNAPSHOT") == false) {
                println project.name + ' RELEASE BUILD'
                repositoryUrl = project.hasProperty('mavenReleaseUrl')
            } else {
                println project.name + ' SNAPSHOT BUILD'
                repositoryUrl = project.hasProperty('mavenSnapshotsUrl')
            }

            def userName = project.hasProperty('mavenUser') ? mavenUser : ""
            def password = project.hasProperty('mavenPass') ? mavenPass : ""
            repository(url: repositoryUrl) {
                authentication(userName: userName, password: password)
            }

            pom.project {
                name 'fataar-plugin'
                description projectDesc
                groupId GROUP
                version VERSION_NAME
            }
        }
    }
}

